@page "/counter"
@using BetBalance.Db

<h1>Counter</h1>

<p role="status">Current count: @currentCount</p>

<button class="btn btn-primary" @onclick="Save">Save</button>

<button class="btn btn-primary" @onclick="GetCount">Get</button>

<p role="status">Folder: @path</p>

@code {

    [Inject] public BetDatabase BetDatabase { get; set; }
    private int currentCount = 0;
    private string path = string.Empty;

    protected override async Task OnInitializedAsync()
    {
        await Task.Delay(500);

        await BetDatabase.Init();

        path = Constants.DatabasePath;
        Console.WriteLine("--the end counter---");
    }

    private async Task GetCount()
    {

        var bets = await BetDatabase.GetItemsAsync();
        currentCount = bets.Count();
    }

    private async Task Save()
    {
        Bet bet = new()
            {
                Date = DateTime.Now,
                Amount = 100,
                Bookmaker = "лига ставок"
            };

        await BetDatabase.SaveItemAsync(bet);
    }
}
